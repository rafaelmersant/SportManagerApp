(this.webpackJsonpFenix=this.webpackJsonpFenix||[]).push([[0],{199:function(e,t,a){},203:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(38),l=a.n(o),s=a(210),c=(a(99),a(7)),i=a(8),u=a(9),m=a(10),d=a(212),p=a(93),h=a(211),f=a(13),g=a(5),b=a.n(g),v=a(11),E=a(18),y=a.n(E),w=function(e){var t=e.itemsCount,a=e.pageSize,n=e.currentPage,o=e.onPageChange,l=Math.ceil(t/a);if(1===l)return null;var s=y.a.range(1,l+1);return r.a.createElement("nav",null,r.a.createElement("ul",{className:"pagination",style:{display:"table"}},s.map((function(e){return r.a.createElement("li",{style:{display:"inline-block"},key:e,className:e===n?"page-item active":"page-item"},r.a.createElement("button",{className:"page-link",onClick:function(){return o(e)}},e))}))))},x=a(37),N=function(e){var t=e.name,a=e.label,n=e.error,o=Object(x.a)(e,["name","label","error"]);return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:t}," ",a," "),r.a.createElement("input",Object.assign({},o,{name:t,id:t,className:"form-control"})),n&&r.a.createElement("div",{className:"alert alert-danger"},n))},S=function(e){var t=e.value,a=e.onChange,n=e.placeholder,o=e.label,l=void 0===o?"":o;return r.a.createElement(N,{type:"text",name:"query",className:"form-control my-3",placeholder:n,value:t,label:l,onChange:function(e){return a(e.currentTarget.value)},autoComplete:"off"})},_=a(209),O=function(e){var t=e.label,a=e.to;return r.a.createElement(_.a,{className:"btn btn-fenix-yellow pull-right",to:a},t)},k=function(e){return r.a.createElement("div",{className:"spinner-border text-warning",style:{width:"5rem",height:"5rem"},role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))};function C(e,t,a){var n=(t-1)*a;return y()(e).slice(n).take(a).value()}var j=a(12),D=a(33),P=a.n(D);var U={init:function(){},log:function(e){console.log(e)}};P.a.interceptors.response.use(null,(function(e){if(e.response&&e.response.status>=400&&e.response.status<500){var t=e.response.data,a="";if("null"!==t){for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];a+="".concat(n," : ").concat(r[0],"\n")}f.toast.error(a)}}else U.log(e),f.toast.error("An unexpected error occurred.");return Promise.reject(e)}));var I={get:P.a.get,post:P.a.post,put:P.a.put,delete:P.a.delete,setJwt:function(e){P.a.defaults.headers.common["x-auth-token"]=e}},A=a(27),L="".concat(A.a,"/athletes"),M="".concat(A.a,"/parents"),T="".concat(A.a,"/documents");function F(e){return"".concat(L,"/").concat(e)}function z(e){return"".concat(M,"/").concat(e)}function B(e){return"".concat(T,"/").concat(e)}function q(e,t){return I.get("".concat(L,"/?first_name=").concat(e,"&last_name=").concat(t))}function R(e){return I.get("".concat(L,"/?id=").concat(e))}function J(e){if(e.id){var t=Object(j.a)({},e);return delete t.id,I.put(F(e.id),t)}return I.post("".concat(L,"/"),e)}function Q(e){return I.delete(F(e))}function Y(e){return I.get("".concat(M,"/?athlete_id=").concat(e))}function V(e){return I.get("".concat(M,"/?id=").concat(e))}function G(e){if(e.id){var t=Object(j.a)({},e);return delete t.id,I.put(z(e.id),t)}return I.post("".concat(M,"/"),e)}function K(e){return I.delete(z(e))}function W(e){return I.get("".concat(T,"/?athlete_id=").concat(e))}function H(e){return I.get("".concat(T,"/?id=").concat(e))}function X(e){if(e.id){var t=Object(j.a)({},e);return delete t.id,I.put(B(e.id),t)}return I.post("".concat(T,"/"),e)}function $(e){return I.delete(B(e))}var Z=a(67),ee=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).raiseSort=function(t){var a=Object(j.a)({},e.props.sortColumn);a.path===t?a.order="asc"===a.order?"desc":"asc":(a.path=t,a.order="asc"),e.props.onSort(a)},e.renderSortIcon=function(t){var a=e.props.sortColumn;return t.path!==a.path?null:"asc"===a.order?r.a.createElement("i",{className:"fa fa-sort-asc"}):r.a.createElement("i",{className:"fa fa-sort-desc"})},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("thead",{className:"bg-fenix-blue text-fenix-yellow"},r.a.createElement("tr",null,this.props.columns.map((function(t){return r.a.createElement("th",{className:"clickable "+t.align,key:t.path||t.key,onClick:function(){return e.raiseSort(t.path)}},t.label," ",e.renderSortIcon(t))}))))}}]),a}(n.Component);function te(e){return parseFloat(e).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")}var ae=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).renderCell=function(t,a){return a.content?a.content(t):a.path.toLowerCase().includes("duedate")?e.formatDateWithoutTime(y.a.get(t,a.path)):a.path.toLowerCase().includes("date")?e.formatDate(y.a.get(t,a.path)):a.path.toLowerCase().includes("price")||a.path.toLowerCase().includes("cost")||a.path.toLowerCase().includes("quantity")||a.path.toLowerCase().includes("itbis")||a.path.toLowerCase().includes("discount")||a.path.toLowerCase().includes("total")?te(y.a.get(t,a.path)):y.a.get(t,a.path)},e.createKey=function(e,t){return e.id+(t.path||t.key)},e.formatDate=function(e){var t=new Date(e).toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),a=new Date(e).toLocaleDateString();return"".concat(a," ").concat(t)},e.formatDateWithoutTime=function(e){return new Date(e).toLocaleDateString()},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.columns;return r.a.createElement("tbody",null,a.map((function(t){return r.a.createElement("tr",{key:t.product_id||t.id},n.map((function(a){return r.a.createElement("td",{key:e.createKey(t,a),className:a.classes,ref:function(e){e&&e.style.setProperty("padding","0.30rem","important")}},e.renderCell(t,a))})))})))}}]),a}(n.Component),ne=function(e){var t=e.columns,a=e.sortColumn,n=e.onSort,o=e.data;return r.a.createElement("table",{className:"table table-striped table-bordered"},r.a.createElement(ee,{columns:t,sortColumn:a,onSort:n}),r.a.createElement(ae,{columns:t,data:o}))},re="https://firebasestorage.googleapis.com/v0/b/fenix-system-8a811.appspot.com/o/photos%2Fprofile-default.png?alt=media&token=04c86bfc-36cf-4e2b-8b71-20531d960b70",oe="".concat(A.a,"/auth"),le="ms_userId",se="ms_email",ce="ms_name",ie="ms_role";function ue(){return(ue=Object(v.a)(b.a.mark((function e(t){var a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.post("".concat(oe,"/login/"),t);case 2:a=e.sent,n=a.data,localStorage.setItem(le,n.id),localStorage.setItem(se,n.email),localStorage.setItem(ce,n.name),localStorage.setItem(ie,n.role);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(){try{return localStorage.getItem(se)?{id:parseInt(localStorage.getItem(le)),name:localStorage.getItem(ce),email:localStorage.getItem(se),role:localStorage.getItem(ie)}:null}catch(e){return null}}var de={login:function(e){return ue.apply(this,arguments)},logout:function(){localStorage.removeItem(le),localStorage.removeItem(se),localStorage.removeItem(ce),localStorage.removeItem(ie)},getCurrentUser:me},pe=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a),(e=t.call(this)).columns=[{path:"photo",label:"Foto",content:function(e){return r.a.createElement(Z.a,{to:"/athlete/".concat(e.id)},r.a.createElement("div",{className:"text-center"},r.a.createElement("div",{className:"border rounded-circle d-inline-block",style:{width:"75px",height:"75px",backgroundImage:"url("+(e.photo?e.photo:re)+")",backgroundSize:"cover"}})))}},{path:"first_name",label:"Nombre",classes:"align-middle",content:function(e){return r.a.createElement(Z.a,{to:"/athlete/".concat(e.id)},e.first_name)}},{path:"last_name",label:"Apellido",classes:"align-middle",content:function(e){return r.a.createElement(Z.a,{to:"/athlete/".concat(e.id)}," ",e.last_name," ")}},{path:"age",label:"Edad",classes:"align-middle",content:function(e){return r.a.createElement("span",null,e.age," a\xf1os")}},{path:"creation_date",label:"Creado (m/d/a)",align:"d-none d-md-table-cell d-lg-table-cell border-0",classes:"align-middle d-none d-md-table-cell d-lg-table-cell border-0"}],e.deleteColumn={key:"delete",classes:"align-middle",content:function(t){return r.a.createElement("div",{className:"text-center pl-2 pr-2"},r.a.createElement("span",{onClick:function(){return e.props.onDelete(t)},className:"fa fa-trash",style:{color:"red",fontSize:"24px",cursor:"pointer"}}))}};var n=de.getCurrentUser().email,o=de.getCurrentUser().role;return!n||"Admin"!==o&&"Owner"!==o||e.columns.push(e.deleteColumn),e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.athletes,a=e.sortColumn,n=e.onSort;return r.a.createElement(ne,{columns:this.columns,data:t,sortColumn:a,onSort:n})}}]),a}(n.Component),he=a(19),fe=a.n(he),ge=(a(45),function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={loading:!0,athletes:[],currentPage:1,pageSize:10,searchQuery:"",sortColumn:{path:"creationDate",order:"desc"}},e.handleDelete=function(){var t=Object(v.a)(b.a.mark((function t(a){var n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.confirm("Esta seguro de eliminar al atleta ".concat(a.first_name," ").concat(a.last_name,"? \nNo podr\xe1 deshacer esta acci\xf3n"))){t.next=15;break}return n=e.state.athletes,r=e.state.athletes.filter((function(e){return e.id!==a.id})),e.setState({athletes:r}),t.prev=5,t.next=8,Q(a.id);case 8:a.photo_filename&&fe.a.storage().ref("photos").child(a.photo_filename).delete().then((function(){console.log("file ".concat(a.photo_filename," deleted"))})).catch((function(e){console.log(e)})),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(5),t.t0.response&&404===t.t0.response.status&&f.toast.error("Este atleta ya fue eliminado"),e.setState({athletes:n});case 15:case"end":return t.stop()}}),t,null,[[5,11]])})));return function(e){return t.apply(this,arguments)}}(),e.handlePageChange=function(t){e.setState({currentPage:t})},e.handleSearch=function(t){e.setState({searchQuery:t,currentPage:1})},e.handleSort=function(t){e.setState({sortColumn:t})},e.getPagedData=function(){var t=e.state,a=t.pageSize,n=t.currentPage,r=t.sortColumn,o=t.searchQuery,l=t.athletes,s=l;o&&(s=l.filter((function(e){return"".concat(e.first_name.toLowerCase()," ").concat(e.last_name.toLowerCase()).includes(o.toLocaleLowerCase())})));var c=C(y.a.orderBy(s,[r.path],[r.order]),n,a);return{totalCount:s.length,athletes:c}},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.get("".concat(L,"/"));case 2:t=e.sent,a=t.data,this.setState({athletes:a,loading:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.pageSize,a=e.currentPage,n=e.sortColumn,o=e.searchQuery,l=this.props.user,s=this.getPagedData(),c=s.totalCount,i=s.athletes;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col margin-top-msg"},r.a.createElement("h5",{className:"pull-left text-fenix-blue mt-2"},"Listado de Atletas"),r.a.createElement("div",{className:"mb-4"},r.a.createElement(O,{label:"Nuevo Atleta",to:"/athlete/new"})),r.a.createElement(S,{value:o,onChange:this.handleSearch,placeholder:"Buscar..."}),this.state.loading&&r.a.createElement("div",{className:"d-flex justify-content-center mb-3"},r.a.createElement(k,null)),!this.state.loading&&i.length>0&&r.a.createElement(pe,{athletes:i,user:l,sortColumn:n,onDelete:this.handleDelete,onSort:this.handleSort}),!this.state.loading&&i.length>0&&r.a.createElement("div",{className:"row"},r.a.createElement(w,{itemsCount:c,pageSize:t,currentPage:a,onPageChange:this.handlePageChange}),r.a.createElement("p",{className:"text-muted ml-3 mt-2"},r.a.createElement("em",null,"Mostrando ",i.length," de ",c," atletas"))),!i.length>0&&r.a.createElement("div",{className:"text-center mt-3",style:{paddingBottom:"8rem"}},r.a.createElement("span",{className:"fa fa-user text-muted",style:{fontSize:"6em"}}),r.a.createElement("h2",{className:"text-secondary"},"A\xfan no ha agregado atletas"),r.a.createElement("h4",{className:"text-secondary"},"Buen momento para iniciar")))))}}]),a}(n.Component)),be=function(e){return r.a.createElement("ul",{className:"nav nav-tabs",id:"myTab",role:"tablist"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link active",id:"profile-tab","data-toggle":"tab",href:"#profile",role:"tab","aria-controls":"profile","aria-selected":"true"},"Perfil")),"new"!==e.match.params.id&&r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link",id:"parent-tab","data-toggle":"tab",href:"#parent",role:"tab","aria-controls":"parent","aria-selected":"false"},"Relacionados")),"new"!==e.match.params.id&&r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link",id:"document-tab","data-toggle":"tab",href:"#document",role:"tab","aria-controls":"document","aria-selected":"false"},"Documentos")))},ve=a(48),Ee=a.n(ve),ye=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={avatar:"",photo:"",progress:0,isUploading:!1},e.handleChangePhoto=function(t){var a=t.target.files[0];e.setState({selectedPhoto:a,photo:URL.createObjectURL(t.target.files[0])})},e.handleUploadStart=function(){return e.setState({isUploading:!0})},e.handleProgress=function(t){return e.setState({progress:t})},e.handleUploadError=function(t){e.setState({isUploading:!1}),console.error(t)},e.handleUploadSuccess=function(t){e.setState({avatar:t,progress:100,isUploading:!1}),fe.a.storage().ref("photos").child(t).getDownloadURL().then((function(a){e.setState({photo:a}),e.props.onChangePhoto({url:a,filename:t,changed:!0})}))},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.photo?this.props.photo:re,t=Object(j.a)({},this.state),a=t.photo,n=t.progress,o=t.isUploading;return a=a||e,r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"text-center"},r.a.createElement("div",{id:"container"}),r.a.createElement("div",{className:"border shadow rounded-circle d-inline-block",style:{width:"170px",height:"170px",backgroundImage:"url("+a+")",backgroundSize:"cover"}})),r.a.createElement("div",{className:"text-center"},o&&r.a.createElement("div",{className:"progress"},r.a.createElement("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(n,"%")},"aria-valuenow":n,"aria-valuemin":"0","aria-valuemax":"100"},n,"%")),r.a.createElement("label",null,r.a.createElement(Ee.a,{hidden:!0,accept:"image/*",name:"avatar",randomizeFilename:!0,storageRef:fe.a.storage().ref("photos"),onUploadStart:this.handleUploadStart,onUploadError:this.handleUploadError,onUploadSuccess:this.handleUploadSuccess,onProgress:this.handleProgress}),r.a.createElement("h6",{className:"text-info",style:{cursor:"pointer"}},"Cargar foto"))))}}]),a}(n.Component),we=a(6),xe=a.n(we),Ne=a(89),Se=a.n(Ne),_e=(a(137),a(41)),Oe=a(92),ke=function(e){var t=e.name,a=e.label,n=e.options,o=e.error,l=Object(x.a)(e,["name","label","options","error"]);return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:t}," ",a," "),r.a.createElement("select",Object.assign({name:t,id:t},l,{className:"form-control"}),r.a.createElement("option",{value:""}),n.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name?e.name:e.description)}))),o&&r.a.createElement("div",{className:"alert alert-danger"},o))},Ce=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{},erros:{}},e.validate=function(){var t=xe.a.validate(e.state.data,e.schema,{abortEarly:!1}).error;if(!t)return null;var a,n={},r=Object(Oe.a)(t.details);try{for(r.s();!(a=r.n()).done;){var o=a.value;n[o.path[0]]=o.message}}catch(l){r.e(l)}finally{r.f()}return n},e.validateProperty=function(t){var a=t.name,n=t.value,r=Object(_e.a)({},a,n),o=Object(_e.a)({},a,e.schema[a]),l=xe.a.validate(r,o).error;return l?l.details[0].message:null},e.handleSubmit=function(t){t.preventDefault();var a=e.validate();e.setState({errors:a||{}}),a||e.doSubmit()},e.handleChange=function(t){var a=t.currentTarget,n=Object(j.a)({},e.state.errors),r=e.validateProperty(a);r?n[a.name]=r:delete n[a.name];var o=Object(j.a)({},e.state.data);o[a.name]=a.value,e.setState({data:o,errors:n})},e}return Object(i.a)(a,[{key:"renderButton",value:function(e){return r.a.createElement("button",{disabled:this.validate(),className:"btn bg-fenix-yellow pl-5 pr-5"},e)}},{key:"renderSelect",value:function(e,t,a){var n=this.state,o=n.data,l=n.errors;return r.a.createElement(ke,{name:e,value:o[e],label:t,options:a,onChange:this.handleChange,error:l[e]})}},{key:"renderInput",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=this.state,s=l.data,c=l.errors;return r.a.createElement(N,{disabled:n,type:a,name:e,value:s[e],label:t,onChange:this.handleChange,error:c[e],placeholder:o,autoComplete:"off"})}}]),a}(n.Component),je=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{id:0,first_name:"",last_name:"",email:"",address:"",phone_number:"",photo:"",photo_filename:"",birthday:"",enrollment_year:(new Date).getFullYear(),enrollment_month:(new Date).getMonth()+1,medical_information:"",created_user:me().email,creation_date:(new Date).toISOString()},errors:{},action:"Nuevo Atleta",birthday:"",enrollmentYears:[],enrollmentMonths:[]},e.schema={id:xe.a.number(),first_name:xe.a.string().required().max(100).label("Nombre"),last_name:xe.a.string().required().max(100).label("Apellidos"),email:xe.a.optional(),address:xe.a.optional(),phone_number:xe.a.optional(),photo:xe.a.optional(),photo_filename:xe.a.optional(),birthday:xe.a.string(),enrollment_year:xe.a.optional(),enrollment_month:xe.a.optional(),medical_information:xe.a.optional(),created_user:xe.a.string(),creation_date:xe.a.string()},e.handleChangeBirthday=function(t){var a=Object(j.a)({},e.state.data);a.birthday=t.toJSON().substr(0,10),e.setState({data:a,birthday:t})},e.doSubmit=Object(v.a)(b.a.mark((function t(){var a,n,r,o,l,s,c;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q(e.state.data.first_name.toUpperCase(),e.state.data.last_name.toUpperCase());case 2:if(a=t.sent,!(a.data.length>0&&0===e.state.data.id)){t.next=7;break}return f.toast.error("Este atleta ya existe!"),t.abrupt("return",!1);case 7:return n=Object(j.a)({},e.state),(r=n.data).first_name=r.first_name.toUpperCase(),r.last_name=r.last_name.toUpperCase(),r.birthday=r.birthday?new Date(e.state.birthday).toJSON().substr(0,10):"",r.photo=0===r.id?"":r.photo,sessionStorage.newPhoto&&(o=Object(j.a)({},e.state.data),l=o.photo_filename,r.photo=sessionStorage.newPhoto,r.photo_filename=sessionStorage.newPhoto_filename),t.next=15,J(r);case 15:s=t.sent,c=s.data,console.log(c),l&&fe.a.storage().ref("photos").child(l).delete().then((function(){console.log("file ".concat(l," deleted"))})).catch((function(e){console.log(e)})),sessionStorage.newPhoto="",sessionStorage.newPhoto_filename="",window.location="/athlete/".concat(c.id);case 22:case"end":return t.stop()}}),t)}))),e}return Object(i.a)(a,[{key:"populateAthlete",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,a,n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"new"!==(t=this.props.match.params.id)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,R(t);case 6:a=e.sent,n=a.data,r=this.mapToViewModel(n),this.setState({data:r,action:"Editar Atleta",birthday:new Date(n[0].birthday.split("-").join("/"))}),this.props.onChangePhoto({url:n[0].photo,filename:n[0].photo_filename}),e.next=17;break;case 13:if(e.prev=13,e.t0=e.catch(0),!e.t0.response||404!==e.t0.response.status){e.next=17;break}return e.abrupt("return",this.props.history.replace("/not-found"));case 17:case"end":return e.stop()}}),e,this,[[0,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"populateEnrollmentYears",value:function(){for(var e=(new Date).getFullYear(),t=[];e>=2e3;)t.push({id:e,name:e}),e-=1;this.setState({enrollmentYears:t})}},{key:"populateEnrollmentMonths",value:function(){var e=[];["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"].forEach((function(t,a){e.push({id:a+1,name:t})})),this.setState({enrollmentMonths:e})}},{key:"componentDidMount",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.populateEnrollmentYears(),this.populateEnrollmentMonths(),e.next=4,this.populateAthlete();case 4:this.props.athleteName&&this.props.athleteName.length&&((t=Object(j.a)({},this.state.data)).first_name=this.props.athleteName,this.setState({data:t}),this.forceUpdate());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"mapToViewModel",value:function(e){return{id:e[0].id,first_name:e[0].first_name,last_name:e[0].last_name,email:e[0].email?e[0].email:"",address:e[0].address?e[0].address:"",phone_number:e[0].phone_number?e[0].phone_number:"",photo:e[0].photo?e[0].photo:"",photo_filename:e[0].photo_filename?e[0].photo_filename:"",birthday:e[0].birthday?e[0].birthday:"",enrollment_year:e[0].enrollment_year?e[0].enrollment_year:"",enrollment_month:e[0].enrollment_month?e[0].enrollment_month:"",medical_information:e[0].medical_information?e[0].medical_information:"",created_user:e[0].created_user?e[0].created_user:me().email,creation_date:e[0].creation_date}}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"text-fenix-yellow bg-fenix-blue pl-1 pr-1 pt-1 pb-1"},this.state.action),r.a.createElement("div",{className:"col-12 pb-5 bg-light"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-6 col-md-6 col-sm-12"},this.renderInput("first_name","Nombre")),r.a.createElement("div",{className:"col-lg-6 col-md-6 col-sm-12"},this.renderInput("last_name","Apellidos"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-6 col-md-6 col-sm-12"},this.renderInput("email","Email")),r.a.createElement("div",{className:"col-lg-6 col-md-6 col-sm-12"},this.renderInput("phone_number","Tel\xe9fono"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-3 col-md-3 col-sm-12"},this.renderSelect("enrollment_year","A\xf1o de Inscripci\xf3n",this.state.enrollmentYears)),r.a.createElement("div",{className:"col-lg-3 col-md-3 col-sm-12"},this.renderSelect("enrollment_month","Mes de Inscripci\xf3n",this.state.enrollmentMonths)),r.a.createElement("div",{className:"col-6"},r.a.createElement("label",{className:"d-block"},"Fecha de Nacimiento"),r.a.createElement(Se.a,{selected:this.state.birthday,onChange:function(t){return e.handleChangeBirthday(t)},dateFormat:"dd/MM/yyyy"}))),this.renderInput("address","Direcci\xf3n","text","","Opcional"),this.renderInput("medical_information","Informaci\xf3n m\xe9dica"),r.a.createElement("div",{className:"text-center mt-2"},this.renderButton("Guardar")))))}}]),a}(Ce),De=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a),(e=t.call(this)).columns=[{path:"name",label:"Nombre"},{path:"phone_number",label:"Tel\xe9fono"},{path:"email",label:"Email"}],e.actionColumn={path:"action",key:"action",classes:"text-center",content:function(t){return r.a.createElement("div",null,r.a.createElement("div",{className:"d-inline-block mr-1"},r.a.createElement("span",{onClick:function(){return e.props.onDelete(t)},className:"fa fa-trash text-danger",style:{fontSize:"22px",cursor:"pointer"}})),r.a.createElement("div",{className:"d-inline-block ml-1"},r.a.createElement("span",{onClick:function(){return e.props.onEdit(t)},className:"fa fa-edit text-warning",style:{fontSize:"22px",cursor:"pointer"}})))}};var n=de.getCurrentUser().email,o=de.getCurrentUser().role;return!n||"Admin"!==o&&"Owner"!==o||e.columns.push(e.actionColumn),e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.parents,a=e.sortColumn,n=e.onSort;return r.a.createElement(ne,{columns:this.columns,data:t,sortColumn:a,onSort:n})}}]),a}(n.Component),Pe=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{id:0,athlete_id:parseInt(e.props.match.params.id),name:"",phone_number:"",email:"",created_user:me().email,creation_date:(new Date).toISOString()},parents:[],errors:{}},e.schema={id:xe.a.number(),athlete_id:xe.a.number(),name:xe.a.string().required().max(150).label("Nombre"),phone_number:xe.a.optional(),email:xe.a.optional(),created_user:xe.a.string(),creation_date:xe.a.string()},e.handleSort=function(){console.log("sorted")},e.handleDeleteParent=function(){var t=Object(v.a)(b.a.mark((function t(a){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.confirm("Seguro que desea eliminar a: ".concat(a.name))){t.next=12;break}return t.prev=2,t.next=5,K(a.id);case 5:n=t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),t.t0.response&&404===t.t0.response.status&&f.toast.error("Este registro ya fue eliminado");case 11:n&&200===n.status&&(f.toast.success("".concat(a.name," fue eliminado con exito!")),e.populateParents());case 12:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}(),e.handleEditParent=function(){var t=Object(v.a)(b.a.mark((function t(a){var n,r,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return function(e){e.preventDefault()}(window.event),t.next=4,V(a.id);case 4:n=t.sent,(r=n.data)&&(o={id:r[0].id,athlete_id:r[0].athlete.id,name:r[0].name,phone_number:r[0].phone_number,email:r[0].email,created_user:me().email,creation_date:(new Date).toISOString()},e.setState({data:o}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.doSubmit=Object(v.a)(b.a.mark((function t(){var a,n,r,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Object(j.a)({},e.state),(n=a.data).name=n.name.toUpperCase(),t.prev=2,t.next=5,G(n);case 5:r=t.sent,o=r.data,n.id=0,n.name="",n.phone_number="",n.email="",e.setState({data:n}),console.log(o),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),console.log(t.t0);case 18:return t.next=20,e.populateParents();case 20:f.toast.success("Agregado con exito!");case 21:case"end":return t.stop()}}),t,null,[[2,15]])}))),e}return Object(i.a)(a,[{key:"populateParents",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"new"!==(t=this.props.match.params.id)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,Y(t);case 6:a=e.sent,n=a.data,this.setState({parents:n}),e.next=15;break;case 11:if(e.prev=11,e.t0=e.catch(0),!e.t0.response||404!==e.t0.response.status){e.next=15;break}return e.abrupt("return",this.props.history.replace("/not-found"));case 15:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(v.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.populateParents();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"mapToViewModel",value:function(e){return{id:e[0].id,athlete_id:e[0].athlete_id,name:e[0].name,phone_number:e[0].phone_number?e[0].phone_number:"",email:e[0].email?e[0].email:"",created_user:e[0].created_user?e[0].created_user:me().email,creation_date:e[0].creation_date}}},{key:"render",value:function(){var e=Object(j.a)({},this.state).parents;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("h4",{className:"text-fenix-yellow bg-fenix-blue pl-1 pr-1 pt-1 pb-1"},"Agregar un Relacionado"),r.a.createElement("div",{className:"col-12 pb-3 mb-3 bg-light"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-4 col-md-4 col-sm-12"},this.renderInput("name","Nombre")),r.a.createElement("div",{className:"col-lg-4 col-md-4 col-sm-12"},this.renderInput("phone_number","Tel\xe9fonos")),r.a.createElement("div",{className:"col-lg-4 col-md-4 col-sm-12"},this.renderInput("email","Email"))),r.a.createElement("div",{className:"text-left"},this.renderButton("Guardar"))))),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},e.length>0&&r.a.createElement("div",{style:{minHeight:"330px"}},r.a.createElement(De,{parents:e,sortColumn:{path:"name",order:"asc"},onDelete:this.handleDeleteParent,onEdit:this.handleEditParent,onSort:this.handleSort})),!e.length>0&&r.a.createElement("div",{className:"text-center mt-3",style:{paddingBottom:"8rem"}},r.a.createElement("span",{className:"fa fa-users text-muted",style:{fontSize:"6em"}}),r.a.createElement("h2",{className:"text-secondary"},"A\xfan no ha agregado relacionados"),r.a.createElement("h4",{className:"text-secondary"},"Buen momento para iniciar"))))))}}]),a}(Ce),Ue=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a),(e=t.call(this)).columns=[{path:"title",label:"Titulo"},{path:"document_url",label:"Archivo",align:"text-center",classes:"text-center",content:function(e){return r.a.createElement("a",{href:e.document_url,target:"_blank",rel:"noopener noreferrer"},r.a.createElement("div",{className:"text-center"},r.a.createElement("span",{className:"fa fa-file"})))}},{path:"creation_date",label:"Agregado",align:"text-center",classes:"text-center"}],e.actionColumn={path:"action",key:"action",classes:"text-center",content:function(t){return r.a.createElement("div",null,r.a.createElement("div",{className:"d-inline-block mr-1"},r.a.createElement("span",{onClick:function(){return e.props.onDelete(t)},className:"fa fa-trash text-danger",style:{fontSize:"22px",cursor:"pointer"}})),r.a.createElement("div",{className:"d-inline-block ml-1"},r.a.createElement("span",{onClick:function(){return e.props.onEdit(t)},className:"fa fa-edit text-warning",style:{fontSize:"22px",cursor:"pointer"}})))}};var n=de.getCurrentUser().email,o=de.getCurrentUser().role;return!n||"Admin"!==o&&"Owner"!==o||e.columns.push(e.actionColumn),e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.documents,a=e.sortColumn,n=e.onSort;return r.a.createElement(ne,{columns:this.columns,data:t,sortColumn:a,onSort:n})}}]),a}(n.Component),Ie=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{id:0,athlete_id:parseInt(e.props.match.params.id),title:"",document_url:"",document_filename:"",created_user:me().email,creation_date:(new Date).toISOString()},documents:[],errors:{},documentName:"",progress:0,isUploading:!1},e.schema={id:xe.a.number(),athlete_id:xe.a.number(),title:xe.a.string().required().max(150).label("Titulo"),document_url:xe.a.string(),document_filename:xe.a.string(),created_user:xe.a.string(),creation_date:xe.a.string()},e.handleSort=function(){console.log("sorted")},e.handleDeleteDocument=function(){var t=Object(v.a)(b.a.mark((function t(a){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.confirm("Seguro que desea eliminar: ".concat(a.title))){t.next=13;break}return t.prev=2,t.next=5,$(a.id);case 5:n=t.sent,fe.a.storage().ref("documents").child(a.document_filename).delete().then((function(){console.log("file ".concat(a.document_filename," deleted"))})).catch((function(e){console.log(e)})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),t.t0.response&&404===t.t0.response.status&&f.toast.error("Este registro ya fue eliminado");case 12:n&&200===n.status&&(f.toast.success("".concat(a.title," fue eliminado con exito!")),e.populateDocuments());case 13:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}(),e.handleEditDocument=function(){var t=Object(v.a)(b.a.mark((function t(a){var n,r,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return function(e){e.preventDefault()}(window.event),t.next=4,H(a.id);case 4:n=t.sent,(r=n.data)&&(o={id:r[0].id,athlete_id:r[0].athlete.id,title:r[0].title,document_url:r[0].document_url,created_user:me().email,creation_date:(new Date).toISOString()},e.setState({data:o}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleUploadStart=function(){return e.setState({isUploading:!0})},e.handleProgress=function(t){return e.setState({progress:t})},e.handleUploadError=function(t){e.setState({isUploading:!1}),f.toast.error("Hubo un error al tratar de cargar el documento \n ".concat(t)),console.error(t)},e.handleUploadSuccess=function(t){e.setState({documentName:t,progress:100,isUploading:!1});var a=Object(j.a)({},e.state).data;fe.a.storage().ref("documents").child(t).getDownloadURL().then((function(n){a.document_url=n,a.document_filename=t,e.setState({data:a})}))},e.doSubmit=Object(v.a)(b.a.mark((function t(){var a,n,r,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Object(j.a)({},e.state),(n=a.data).title=n.title.toUpperCase(),t.prev=2,t.next=5,X(n);case 5:r=t.sent,o=r.data,n.id=0,n.title="",n.document_url="",e.setState({data:n}),console.log(o),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(2),console.log(t.t0);case 17:return t.next=19,e.populateDocuments();case 19:f.toast.success("Agregado con exito!");case 20:case"end":return t.stop()}}),t,null,[[2,14]])}))),e}return Object(i.a)(a,[{key:"populateDocuments",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"new"!==(t=this.props.match.params.id)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,W(t);case 6:a=e.sent,n=a.data,this.setState({documents:n}),e.next=15;break;case 11:if(e.prev=11,e.t0=e.catch(0),!e.t0.response||404!==e.t0.response.status){e.next=15;break}return e.abrupt("return",this.props.history.replace("/not-found"));case 15:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(v.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.populateDocuments();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"mapToViewModel",value:function(e){return{id:e[0].id,athlete_id:e[0].athlete_id,title:e[0].title,document_url:e[0].document_url?e[0].document_url:"",created_user:e[0].created_user?e[0].created_user:me().email,creation_date:e[0].creation_date}}},{key:"render",value:function(){var e=Object(j.a)({},this.state),t=e.isUploading,a=e.progress,n=e.documents;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("h4",{className:"text-fenix-yellow bg-fenix-blue pl-1 pr-1 pt-1 pb-1"},"Agregar un Documento"),r.a.createElement("div",{className:"col-12 pb-3 mb-3 bg-light"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-6 col-md-6 col-sm-12"},this.renderInput("title","","text","","Titulo del documento")),r.a.createElement("div",{className:"col-lg-3 col-md-3 col-sm-12"},t&&r.a.createElement("div",{className:"progress",style:{marginTop:"38px"}},r.a.createElement("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(a,"%")},"aria-valuenow":a,"aria-valuemin":"0","aria-valuemax":"100"},a,"%")),!t&&r.a.createElement("label",{style:{marginTop:"35px"}},r.a.createElement(Ee.a,{hidden:!0,accept:"*",name:"document",randomizeFilename:!0,storageRef:fe.a.storage().ref("documents"),onUploadStart:this.handleUploadStart,onUploadError:this.handleUploadError,onUploadSuccess:this.handleUploadSuccess,onProgress:this.handleProgress}),r.a.createElement("h6",{className:"text-info",style:{cursor:"pointer"}},this.state.data.document_url&&r.a.createElement("span",{className:"fa fa-file text-warning"})," ","Cargar documento"))),r.a.createElement("div",{className:"col-lg-3 col-md-3 col-sm-12",style:{marginTop:"25px"}},this.renderButton("Guardar")))))),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},n.length>0&&r.a.createElement("div",{style:{minHeight:"370px"}},r.a.createElement(Ue,{documents:n,sortColumn:{path:"name",order:"asc"},onDelete:this.handleDeleteDocument,onEdit:this.handleEditDocument,onSort:this.handleSort})),!n.length>0&&r.a.createElement("div",{className:"text-center mt-3",style:{paddingBottom:"10rem"}},r.a.createElement("span",{className:"fa fa-folder-open text-muted",style:{fontSize:"7em"}}),r.a.createElement("h2",{className:"text-secondary"},"A\xfan no ha agregado documentos"),r.a.createElement("h4",{className:"text-secondary"},"Buen momento para iniciar"))))))}}]),a}(Ce),Ae=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{photo:"",filename:""}},e.handleChangePhoto=function(t){t.changed&&(sessionStorage.newPhoto=t.url,sessionStorage.newPhoto_filename=t.filename);var a=Object(j.a)({},e.state.data);a.photo=t.url,a.filename=t.filename,e.setState({data:a})},e}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"container col-lg-8 col-md-12 col-sm-12 shadow pb-1 bg-white"},r.a.createElement("div",{className:"text-center mb-2 pt-1"},r.a.createElement("div",{className:"text-center"},r.a.createElement(ye,{photo:this.state.data.photo,onChangePhoto:this.handleChangePhoto})),r.a.createElement("div",{className:"mt-2"},r.a.createElement(be,this.props))),r.a.createElement("div",{className:"tab-content",id:"myTabContent"},r.a.createElement("div",{className:"tab-pane fade show active pb-2",id:"profile",role:"tabpanel","aria-labelledby":"profile-tab"},r.a.createElement(je,Object.assign({},this.props,{onChangePhoto:this.handleChangePhoto}))),r.a.createElement("div",{className:"tab-pane fade",id:"parent",role:"tabpanel","aria-labelledby":"parent-tab"},r.a.createElement(Pe,this.props)),r.a.createElement("div",{className:"tab-pane fade",id:"document",role:"tabpanel","aria-labelledby":"document-tab"},r.a.createElement(Ie,this.props))))}}]),a}(n.Component),Le=function(){return r.a.createElement("h1",null,"NotFound")},Me=function(e){var t=e.user;return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light  shadow"},r.a.createElement(_.a,{className:"navbar-brand",to:"/"},r.a.createElement("img",{width:"60px",src:"/images/fenix.png",alt:"FENIX"})),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarTogglerDemo02","aria-controls":"navbarTogglerDemo02","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),!t&&r.a.createElement("div",{className:"text-center w-100"},r.a.createElement("h2",{className:"text-fenix-blue"},"Club Acu\xe1tico LOS F\xc9NIX")),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarTogglerDemo02"},r.a.createElement("ul",{className:"navbar-nav mr-auto mt-2 mt-lg-0"},t&&r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{href:"/athletes/",className:"nav-link"},"Atletas")),t&&"Admin"===t.role&&r.a.createElement("li",{className:"nav-item"},r.a.createElement(_.a,{className:"nav-link",to:"/users"},"Usuarios"))),r.a.createElement("div",{className:"navbar-text"},!t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:"navbar-nav mr-auto mt-2 mt-lg-0"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(_.a,{className:"nav-link",to:"/login"},"Iniciar sesi\xf3n"))))),r.a.createElement("div",{className:"navbar-text"},t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:"navbar-nav mr-auto mt-2 mt-lg-0"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(_.a,{className:"nav-link mr-sm-2 active",to:"/profile"},t.name)),r.a.createElement("li",{className:"nav-item"},r.a.createElement(_.a,{className:"nav-link my-2 my-sm-0",to:"/logout"},"Cerrar sesi\xf3n")))))))},Te=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{email:"",password:""},errors:{}},e.schema={email:xe.a.string().required().label("Email"),password:xe.a.string().required().label("Contrase\xf1a")},e.doSubmit=Object(v.a)(b.a.mark((function t(){var a,n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.state.data,t.next=4,de.login(a);case 4:n=e.props.location.state,window.location=n?n.from.pathname:"/",t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),t.t0.response&&404===t.t0.response.status&&f.toast.error("Email/Contrase\xf1a incorrecto."),t.t0.response&&400===t.t0.response.status&&((r=Object(j.a)({},e.state.errors)).email=t.t0.response.data,e.setState({errors:r}));case 12:case"end":return t.stop()}}),t,null,[[0,8]])}))),e}return Object(i.a)(a,[{key:"render",value:function(){return de.getCurrentUser()?r.a.createElement(h.a,{to:"/"}):r.a.createElement("div",{className:"container col-lg-4 col-md-6 col-sm-11 shadow p-3 mb-5 bg-white rounded"},r.a.createElement("h2",{className:"bg-fenix-blue text-light pl-2 pr-2 pt-1 pb-1"},"Entrar al Sistema"),r.a.createElement("div",{className:"col-12 pb-3 bg-light"},r.a.createElement("form",{onSubmit:this.handleSubmit},this.renderInput("email","Email"),this.renderInput("password","Contrase\xf1a","password"),this.renderButton("Login"))))}}]),a}(Ce),Fe=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"componentDidMount",value:function(){de.logout(),window.location="/login"}},{key:"render",value:function(){return null}}]),a}(n.Component),ze="".concat(A.a,"/users");function Be(e){return"".concat(ze,"/").concat(e)}function qe(e){return I.get("".concat(ze,"/?id=").concat(e))}function Re(e,t){return I.get("".concat(ze,"/?company=").concat(e,"&email=").concat(t))}function Je(e){if(e.id){var t=Object(j.a)({},e);return delete t.id,I.put(Be(e.id),t)}return I.post("".concat(ze,"/"),e)}function Qe(e){return I.delete(Be(e))}var Ye=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a),(e=t.call(this)).columns=[{path:"name",label:"Nombre",content:function(e){return r.a.createElement(Z.a,{to:"/user/".concat(e.id)}," ",e.name," ")}},{path:"email",label:"Email"},{path:"user_role",label:"Rol"},{path:"creation_date",label:"Creado"}],e.deleteColumn={key:"delete",content:function(t){return r.a.createElement("div",{className:"text-center"},r.a.createElement("button",{onClick:function(){return e.props.onDelete(t)},className:"fa fa-trash",style:{color:"red",fontSize:"16px"}}))}};var n=de.getCurrentUser().email,o=de.getCurrentUser().role;return!n||"Admin"!==o&&"Owner"!==o||e.columns.push(e.deleteColumn),e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.users,a=e.sortColumn,n=e.onSort;return r.a.createElement(ne,{columns:this.columns,data:t,sortColumn:a,onSort:n})}}]),a}(n.Component),Ve=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={users:[],currentPage:1,pageSize:10,searchQuery:"",sortColumn:{path:"name",order:"asc"}},e.handleDelete=function(){var t=Object(v.a)(b.a.mark((function t(a){var n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.confirm("Esta seguro de eliminar este usuario? \nNo podr\xe1 deshacer esta acci\xf3n")){t.next=14;break}return n=e.state.users,r=e.state.users.filter((function(e){return e.id!==a.id})),e.setState({users:r}),t.prev=5,t.next=8,Qe(a.id);case 8:t.next=14;break;case 10:t.prev=10,t.t0=t.catch(5),t.t0.response&&404===t.t0.response.status&&f.toast.error("Este usuario ya fue eliminado"),e.setState({users:n});case 14:case"end":return t.stop()}}),t,null,[[5,10]])})));return function(e){return t.apply(this,arguments)}}(),e.handlePageChange=function(t){e.setState({currentPage:t})},e.handleSearch=function(t){e.setState({searchQuery:t,currentPage:1})},e.handleSort=function(t){e.setState({sortColumn:t})},e.getPagedData=function(){var t=e.state,a=t.pageSize,n=t.currentPage,r=t.sortColumn,o=t.searchQuery,l=t.users,s=l;o&&(s=l.filter((function(e){return e.name.toLowerCase().startsWith(o.toLocaleLowerCase())})));var c=C(y.a.orderBy(s,[r.path],[r.order]),n,a);return{totalCount:s.length,users:c}},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.get("".concat(ze,"/"));case 2:t=e.sent,a=t.data,this.setState({users:a});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.pageSize,a=e.currentPage,n=e.sortColumn,o=e.searchQuery,l=this.props.user,s=this.getPagedData(),c=s.totalCount,i=s.users;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col margin-top-msg"},r.a.createElement("div",{className:"mb-4"},r.a.createElement(O,{label:"Nuevo Usuario",to:"/user/new"})),r.a.createElement(S,{value:o,onChange:this.handleSearch,placeholder:"Buscar..."}),r.a.createElement(Ye,{users:i,user:l,sortColumn:n,onDelete:this.handleDelete,onSort:this.handleSort}),r.a.createElement("div",{className:"row"},r.a.createElement(w,{itemsCount:c,pageSize:t,currentPage:a,onPageChange:this.handlePageChange}),r.a.createElement("p",{className:"text-muted ml-3 mt-2"},r.a.createElement("em",null,"Mostrando ",c," usuarios"))))))}}]),a}(n.Component),Ge=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{id:0,email:"",password:"",name:"",user_role:"",user_hash:"hash",created_user:me().email,creation_date:(new Date).toISOString()},roles:[{id:"Admin",name:"Admin"},{id:"Level1",name:"Level1"},{id:"Level2",name:"Level2"},{id:"Reportes",name:"Reportes"}],errors:{},action:"Nuevo Usuario"},e.schema={id:xe.a.number(),email:xe.a.string().required().email().label("Email"),password:xe.a.string().required().min(8).max(30).label("Password"),name:xe.a.string().required().min(5).label("Nombre"),user_role:xe.a.string().required().label("Rol"),user_hash:xe.a.string().optional(),created_user:xe.a.string(),creation_date:xe.a.string()},e.doSubmit=Object(v.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Re(e.state.data.company_id,e.state.data.email);case 2:if(a=t.sent,!a.data.length||0!==e.state.data.id){t.next=7;break}return f.toast.error("Este email ya existe en el sistema."),t.abrupt("return",!1);case 7:return t.next=9,Je(e.state.data);case 9:e.props.history.push("/users");case 10:case"end":return t.stop()}}),t)}))),e}return Object(i.a)(a,[{key:"populateUser",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"new"!==(t=this.props.match.params.id)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,qe(t);case 6:a=e.sent,n=a.data,this.setState({data:this.mapToViewModel(n),action:"Editar Usuario"}),e.next=15;break;case 11:if(e.prev=11,e.t0=e.catch(0),!e.t0.response||404!==e.t0.response.status){e.next=15;break}return e.abrupt("return",this.props.history.replace("/not-found"));case 15:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(v.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.populateUser();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"mapToViewModel",value:function(e){return{id:e[0].id,email:e[0].email,password:e[0].password,name:e[0].name,user_role:e[0].user_role,user_hash:e[0].user_hash?e[0].user_hash:"hash",created_user:e[0].created_user?e[0].created_user:me().email,creation_date:e[0].creation_date}}},{key:"render",value:function(){return r.a.createElement("div",{className:"container pull-left col-5 ml-3 shadow p-3 mb-5 bg-white rounded"},r.a.createElement("h2",{className:"bg-fenix-blue text-fenix-yellow pl-2 pr-2 pt-1 pb-1"},this.state.action),r.a.createElement("div",{className:"col-12 pb-3 bg-light"},r.a.createElement("form",{onSubmit:this.handleSubmit},this.renderInput("email","Email"),this.renderInput("password","Contrase\xf1a","password"),this.renderInput("name","Nombre"),this.renderSelect("user_role","Rol",this.state.roles),this.renderButton("Guardar"))))}}]),a}(Ce),Ke=function(e){var t=e.component,a=e.render,n=Object(x.a)(e,["component","render"]);return r.a.createElement(p.a,Object.assign({},n,{render:function(e){return de.getCurrentUser()?t?r.a.createElement(t,e):a(e):r.a.createElement(h.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},We=(a(198),a(199),function(){return r.a.createElement("div",{className:"text-center"},r.a.createElement("img",{style:{width:"50%"},src:"/images/fenix.png",alt:"FENIX"}))}),He={apiKey:"AIzaSyB0F_8xnemOLHTjKhfgrfQJ4IOhUK3wNks",authDomain:"fenix-system-8a811.firebaseapp.com",databaseURL:"https://fenix-system-8a811.firebaseio.com",projectId:"fenix-system-8a811",storageBucket:"fenix-system-8a811.appspot.com",messagingSenderId:"720726421406",appId:"1:720726421406:web:19084106664ebc5d13308f",measurementId:"G-XQ9YT4CJ40"};fe.a.initializeApp(He);var Xe=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={user:{}},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){try{var e=de.getCurrentUser();this.setState({user:e})}catch(t){"/login"!==window.location.pathname&&window.location.replace("/login")}}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.ToastContainer,null),r.a.createElement(Me,{user:this.state.user}),r.a.createElement("main",null,r.a.createElement(d.a,null,r.a.createElement(p.a,{path:"/login",component:Te}),r.a.createElement(p.a,{path:"/logout",component:Fe}),r.a.createElement(Ke,{path:"/athletes",component:ge}),r.a.createElement(Ke,{path:"/athlete/:id",component:Ae}),r.a.createElement(Ke,{path:"/users",component:Ve}),r.a.createElement(Ke,{path:"/user/:id",component:Ge}),r.a.createElement(p.a,{exact:!0,path:"/",component:We}),r.a.createElement(p.a,{path:"/not-found",component:Le}),r.a.createElement(h.a,{to:"/not-found"}))))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(88),a(201),a(202);l.a.render(r.a.createElement(s.a,null,r.a.createElement(Xe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},27:function(e){e.exports=JSON.parse('{"a":"http://10.0.0.5:8088/api/v1"}')},94:function(e,t,a){e.exports=a(203)},99:function(e,t,a){}},[[94,1,2]]]);
//# sourceMappingURL=main.c9a3f835.chunk.js.map